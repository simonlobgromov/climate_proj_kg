![image](https://github.com/simonlobgromov/climate_proj_kg/assets/131668061/6ecd0a9a-8fa6-4947-982f-184d8edca21c)


# Visualization of climate indicators for Kyrgyzstan.

# Introduction

В эпоху ощутимых климатических изменений, оказывающих глобальное воздействие на природные системы нашей планеты, важность точного и своевременного мониторинга природных ресурсов и экосистем становится все более очевидной. Одним из наиболее важных аспектов данного мониторинга является изучение и анализ снежного покрова, играющего ключевую роль в климатической системе Земли, гидрологии и водных ресурсах. В частности, для горных регионов, таких как Кыргызстан, где ледники и снеговые запасы являются жизненно важными источниками пресной воды, понимание динамики снежного покрова приобретает особую актуальность.

Современные технологии дистанционного зондирования Земли и анализа спутниковых данных открывают новые горизонты в изучении природных процессов. В частности, использование таких инструментов, как Нормализованный Индекс Снегового Покрова (NDSI) и измерения поверхностной температуры, полученные с помощью спутниковых данных NASA, позволяют с высокой точностью определять состояние и динамику снежного покрова. Эти параметры служат основой для оценки текущего состояния ледников, их изменений во времени, а также для прогнозирования будущих изменений в связи с глобальным потеплением.

Настоящая работа посвящена анализу динамики снежного покрова на основе спутниковых данных в контексте оценки состояния ледниковой системы Кыргызстана. Исследование направлено на выявление тенденций изменений снежного покрова и температурных условий, которые могут иметь долгосрочные последствия для водных ресурсов региона, экосистем и социально-экономического благополучия населения. В работе представлены результаты визуализации и анализа полученных данных, что позволяет сделать выводы о текущем состоянии и тенденциях изменений ледников и снежного покрова в Кыргызстане, а также оценить потенциальные риски и вызовы, стоящие перед регионом в ближайшем будущем.


Наблюдения за состоянием снежного покрова и ледников можно разделить на два основных типа:

* **Инструментальные**. Проводятся непосредственно на местности и включают лабораторные изыскания со взятыми материалами.
* **Дистанционные**. Осуществляются с помощью аэрофотосъемки или на основании данных со спутника.

Хотя качественное исследование часто требует комбинации обоих подходов для получения наиболее точной и всесторонней картины, в нашей работе акцент сделан на разработке методологии мониторинга, базирующейся исключительно на анализе спутниковых данных. Этот подход позволяет нам охватить большие территории и получить обобщенное представление о динамике снежного покрова и состоянии ледников, что особенно ценно для регионов с ограниченным доступом или в условиях, когда традиционные наземные измерения затруднены или невозможны.


# Method


В этом разделе мы описываем методы анализа, основанные на изучении оптических свойств снега и льда. Оптический и инфракрасный диапазоны позволяют оценить отражательные характеристики снежного покрова, что важно для выявления его состояния и изменений. Применение разных спектральных каналов обусловлено их чувствительностью к специфическим параметрам снега, включая плотность, структуру и поверхностную температуру. Обсуждается выбор подходящих спектральных каналов для целей мониторинга, а также подходы к обработке и интерпретации спутниковых данных. Это весьма наукоемкая тематика и мы сделали первый шаг в этом направлении.

Для оценки снежного покрова на основе оптических и инфракрасных данных используются следующие ключевые метрики:

* **Нормализованный индекс снежного покрова (NDSI)**: Используется для оценки присутствия и степени снежного покрова на земной поверхности, основываясь на отличии отражательных свойств снега в видимом и ближнем инфракрасном спектре.

* **Индекс ледяного покрова**: Подобен NDSI, но адаптирован для выявления и оценки ледяных и заледенелых поверхностей, особенно полезен для исследования гляциологии.

* **Поверхностная температура (LST - Land Surface Temperature)**: Отражает температуру земной поверхности, включая снег и лед, что критично для оценки процессов таяния и замерзания.

* **Альбедо**: Описывает способность поверхности отражать солнечный свет, что особенно важно для снежного и ледяного покрова, поскольку высокое альбедо снега и льда влияет на климат и энергетический баланс.

* **Индекс площади вегетации (NDVI)**: Хотя преимущественно используется для оценки растительности, NDVI может служить в качестве вторичного индикатора снежного покрова, поскольку снег влияет на показатели растительного покрова.

* **Глубина снежного покрова**: Хотя непосредственно оптические спутниковые данные не позволяют точно измерить глубину снега, косвенные методы и моделирование, основанные на спутниковых данных, могут дать оценки глубины.

* **Влажность снега**: Важный параметр, влияющий на риск лавин и эффективность водопоглощения снегом, может быть оценен через индиректные спутниковые измерения и моделирование.
* **Карта рельефа**: Для оценки процессов в снежном и ледяном покрове необходимо точно знать уровень высоты над уровнем моря, угол наклона поверхности склона, экспозицию склона в виду зависимости от этих признаков  термодинамических режимов.
* **Прозрачность воды во внутренних водоемах**: мутность воды указывает на наличие взвеси микрочастиц в воде, которая является индикатором интенсивного таяния многолетних льдов, когда высвобождаются частицы горных пород, включенных в тело ледника.
*  **Исторические метеоданные**: Данные с метеостанций по температуре воздуха, осадках, ветре ...

Можно увидеть, что это фундаментальное исследование, требующее глубокого анализа собранных больших объемов данных. В настоящий момент мы собрали данные с 2005 года по настоящее время и сделали общий их анализ по таким признакам:

* **Нормализованный индекс снежного покрова (NDSI)**
* **Поверхностная температура (LST - Land Surface Temperature)**
* **Карта рельефа** (Elevation Model)

## MODIS
[MODIS](https://www.earthdata.nasa.gov/) (Moderate Resolution Imaging Spectroradiometer) является ключевым инструментом на борту спутников Terra и Aqua, запущенных NASA для наблюдения за Землей. Инструмент MODIS способен собирать данные в широком спектре длин волн, что позволяет получать разнообразную информацию о состоянии атмосферы, океанов, облаков, а также о земной поверхности, включая растительность, снежный покров и ледники.

## MODIS/Terra Snow Cover Daily L3 Global 500m SIN Grid V061


MODIS/Terra Snow Cover Daily L3 Global 500m SIN Grid V061 представляет собой спутниковый продукт NASA для мониторинга снежного покрова на ежедневной основе с глобальным покрытием и разрешением 500 метров. Используя данные с инструмента MODIS на борту спутника Terra, этот продукт вычисляет Нормализованный Индекс Снежного Покрова (NDSI), который помогает идентифицировать снег, а также эффективно детектирует облачность и водные поверхности для более точной оценки снежного покрова. NDSI рассчитывается по формуле:

$$ NDSI= \frac {Зелёный−SWIR}{Зелёный+SWIR} $$

 

где "Зелёный" обозначает отражение в зелёном спектре, а "SWIR" — отражение в коротковолновом инфракрасном спектре. Этот индекс особенно полезен для определения снежного покрова, поскольку снег имеет высокую отражательную способность в видимом диапазоне и низкую в инфракрасном.

Мы получаем данные в виде числового массива (таблицы) для указанного полигона наблюдения, соответствующего территории Кыргызстана. Значения можно проинтерпретировать согласно данного описания:

```
{'long_name': 'NDSI snow cover from best observation of the day',
 'units': 'none',
 'valid_range': [0, 100],
 '_FillValue': 255,
 'missing_value': 200,
 'Key': ' 0-100=NDSI snow, 200=missing data, 201=no decision, 211=night, 237=inland water, 239=ocean, 250=cloud, 254=detector saturated, 255=fill'}
```

Где мы для всех значений от 0 до 100 понимаем, что это значение NDSI, масштабированное на данный диапазон. Взяв во внимание масштаб наблюдения, мы понимаем, что каждое значение таблицы (пиксель) соответствует территории поверхности размером 500 на 500 метров. Значение 0 определяет поверхность полностью лишенную снежного покрова, а значение 100 соответствует свежевыпавшему снегу.

Если мы провизуализируем данные за один календарный день наблюдений, то получим подобную иллюстрацию:

![image](https://github.com/simonlobgromov/climate_proj_kg/assets/131668061/31afde72-2fac-4a84-9daa-2f634c41f260)

Можем увидеть, что большая территория на выбранном полигоне занята облачностью, и в данных присутствуют артефакты в виде нераспознанных участков, что сильно усложняет анализ. В поисках решения данной проблемы была сформулирована идея, что хотя бы один раз в течение месяца наблюдения каждый пиксель однозначно был идентефицирован как поверхность земли и ему было присвоено значение NDSI. Поэтому было принято решение за каждый день месяца отфильтровать только те пиксели, для которых известен NDSI, и обобщить все результаты за месяц усредняя значения индекса. Также мы оставили пустыми те пиксели, которым соответствует водная поверхность (Озера, реки, водохранилища). Получили такой результат, где отсутствуют облачность и артефакты:

![image](https://github.com/simonlobgromov/climate_proj_kg/assets/131668061/e805624c-9282-4c9f-baf5-d86d0360fe36)

На изображении в качестве примера показан обобщенный NDSI за май 2023 года. Цвет соответствует значению NDSI от 0 (синий, отсутствие снега) до 100 (Красный, свежий снег). Белый цвет соответствует водоемам. Стоит понимать, что свежий снег имеет особые оптические свойства и он хорошо различим оптически. В течение времени снег уплотняется, за счет солнечной радиации его поверхность подтаивает и образующаяся ледяная корка меняет его отражательные свойства, вместе с чем NDSI уменьшается. NDSI близкий к максимальным значениям характеризует те территории, на которых снег выпадает регулярно. 

Попытка обобщить NDSI на меньшем временном интервале (например за 10 дней) показала себя не очень удобной в виду того, что, во-первых, не удается полностью исключить облачность, во-вторых, это приводит к необходимости обрабатывать значительно больший объем данных. Однако, в дальнейшем, мы сделаем более детальный анализ, обобщаясь на меньшем временном интервале.

В работе мы посчитали статистику динамики изменения NDSI по месяцам с Января 2005 года по настоящее время с привязкой к высоте над уровнем моря и построили графики. Также мы на основании данных по NDSI мы для каждого календарного года определили примерную снеговую линию.

## MODISAqua Land Surface Temperature3-Band Emissivity Daily L3 Global 1km SIN Grid Night V061


MODIS/Aqua Land Surface Temperature 3-Band Emissivity Daily L3 Global 1km SIN Grid Night V061 — это спутниковый продукт, предоставляющий ежедневные данные о температуре земной поверхности (LST) и эмиссивности в трех спектральных каналах с разрешением 1 км. Данные собираются инструментом MODIS на спутнике Aqua в **ночное время**, что позволяет минимизировать влияние солнечного излучения и более точно оценить тепловое излучение земной поверхности. Этот продукт использует синусоидальную сетку (SIN Grid) для глобального покрытия и обладает высокой точностью благодаря комплексной методике расчёта, включающей эмиссивность поверхности.

Температура земной поверхности (LST) оценивается на основе радианса, измеренного в инфракрасном диапазоне, с учетом эмиссивности поверхности в трех каналах. Эмиссивность, в свою очередь, характеризует способность поверхности излучать энергию в виде тепла и является ключевым параметром для точного определения LST. Расчет LST и эмиссивности может быть выражен через формулы, основанные на планковском законе об излучении, уравнениях радиационного переноса и коррекции атмосферных эффектов, но точные алгоритмы включают сложные модели и калибровки, специфичные для каждого спектрального канала и условий наблюдения.


Мы получаем данные в виде числового массива (таблицы) для указанного полигона наблюдения, соответствующего территории Кыргызстана. Значения можно проинтерпретировать согласно данного описания:

```
{'long_name': 'Daily 1km Land-surface Temperature',
 'units': 'K',
 'scale_factor': 0.02,
 'add_offset': 0.0,
 'valid_range': [7500, 65535],
 '_FillValue': 0}
```
Где каждому значению (пикселю) соответствует территория площадью $1 km^2$, и если значение пикселя лежит в диапазоне значений $value$ &isin; $[7500, 65535]$, то мы говорим о том, что мы для данного пикселя можем определить значение температуры в цельсиях. Пересчет температуры производился по формуле:

$$T = value*0.02 - 273$$
Где $T$ - температура в градусах Цельсия.

При анализе данных были решены все те же проблемы, как и для NDSI. Данные за день наблюдения имеют посторонние значения в виде облачности, артефактов и аномальных температурных значений. Так выглядит визуализация одного дня наблюдения:

![image](https://github.com/simonlobgromov/climate_proj_kg/assets/131668061/51683641-b8c6-4e7b-9164-d1a730b132a6)

После обобщения за месяц и удаления аномалий мы получили усредненные данные за каждый месяц. Нужно сказать, что температура поверхности не может изменяться столь быстро как температура воздуха. Также для понимания общего температурного режима, усреднение данных за месяц мы посчитали на данном этапе приемлемым. Даже при усреднении за месяц мы наблюдаем множество неидентефицированных пикселей.

Ниже пример визуализации данных по температуре за Май 2023 года:

![image](https://github.com/simonlobgromov/climate_proj_kg/assets/131668061/afa75cd8-5f41-42d7-a415-224de1a12c76)


## ASTER Global Digital Elevation Model

ASTER Global Digital Elevation Model (GDEM) является результатом сотрудничества между NASA и Министерством экономики, торговли и промышленности Японии (METI). Этот инструмент представляет собой цифровую модель высот, обеспечивающую детальное представление о рельефе земной поверхности на глобальном уровне. ASTER GDEM создан на основе данных, собранных инструментом Advanced Spaceborne Thermal Emission and Reflection Radiometer (ASTER), который установлен на спутнике Terra, запущенном NASA.

Мы получили эти данные в высоком разрешении в виде множества числовых массивов, которые объединили, получив карту высот для территории Кыргызстана. 

![image](https://github.com/simonlobgromov/climate_proj_kg/assets/131668061/8dcb6f0f-8ad8-49d1-b995-aad2437cc9d7)

Далее было необходимо сопоставить значения высот с данными NDSI и Surface Temperature, для чего были созданы координатные сетки. Координатные сетки расчитывались на основании известных координат вершин полигона с применением линейной интерполяции, для чего координаты брались в формате "EPSG:3857". Данный формат использует проекцию Меркатора, которая представляет земную поверхность на плоскости так, что все меридианы являются параллельными линиями. Сопоставление данных NDSI и Surface Temperature с картой высот осуществлялся методами математического моделирования. Таким образом для каждого пикселя (участка поверхности земли 500 на 500 метров) мы знали не только индекс снежности и температуру но и высоту над уровнем моря. Это подход в дальнейшем будет распространен и на новые климатические данные.

## Elevation Gradient

Для описания рельефа местности нам необходимо знать не только высотность но и степень перепада высот а также для каждого склона важно знать его экспозицию - то есть к какой стороне света обращен склон. Известен факт, что южные склоны чаще обдуваются ветрами, в следствие чего там преобладают динамические восходящие потоки и обильное облакообразование. Мы подтвердили тот факт, что южные склоны более заснеженны в силу более частого выпадения осадков. 

Так были полученны дополнительные данные по рельефу. Вот пример иллюстрации, полученной на основании карты градиента рельефа: (Иллюстрация имеет искажение и не соответствует картографической картинке рельефа, так как эта картинка подогнана под полинон наблюдений за климатическими данными, который имеет форму параллелограма)

![image](https://github.com/simonlobgromov/climate_proj_kg/assets/131668061/7a62db4b-6cd8-4f3d-ab60-0ac988e39b5c)

Мы располагаем сопоставленными с картами NDSI и температуры поверхности картами:
* С Углами наклона склонов в градусах расчитанных по формулам

$$ (\frac{\partial h}{\partial l})_{max} = |\bigtriangledown h|_2 = \sqrt{(\frac{\partial h}{\partial x})^2 + (\frac{\partial h}{\partial y})^2} $$

$$ \alpha_{slope} = \arctan{(\frac{(\frac{\partial h}{\partial l})_{max}}{| dx, dy|_2})} $$

* С углами экспозиции склонов в градусах (0 - склон обращен на Север, 90 - на Восток, 180 - на Юг, 270 - на Запад)

Вот визуализация угла наклона склонов, где черный цвет соответствует равнинным участкам, светлый описывает крутые склоны, угол которых достигает 88 градусов:

![image](https://github.com/simonlobgromov/climate_proj_kg/assets/131668061/6505c5be-0d10-41cc-811a-de38b04cf153)




# Statistics and visualization

Наше исследование начинается с предварительного анализа полученных данных. На основании их были построены дашборды, которые сохранены в данном репозитории в виде Jypyter ноутбуков. Более подробное описание предложенных графиков имеется внутри каждого файла.

* `NDSI_Visualization_skript.ipynb`
* `Surface_Temperature_Visualization_skript.ipynb`
* `Snow_Line_Visualization_skript.ipynb`

# Results
В рамках нашего исследования были проведены анализы временных рядов NDSI, линии снега и температуры поверхности на основе спутниковых данных за период с 2005 по текущий год. Несмотря на чётко выраженные сезонные колебания, существенных долгосрочных трендов, указывающих на изменение температурного режима или устойчивое снижение снежности в исследуемых высотных зонах, обнаружить не удалось. Эти наблюдения могут свидетельствовать о том, что рассматриваемый регион пока не подвержен значимому воздействию глобального потепления, по крайней мере в рамках рассмотренных признаков и временного промежутка. Однако отсутствие выявленных трендов не исключает необходимости дальнейших исследований. Для более детального понимания потенциального влияния климатических изменений на снежный покров необходимо провести комплексный анализ, привлекая дополнительные данные и новые признаки, такие как модели атмосферных осадков, термические характеристики снежного покрова, альбедо, массовый и энергетический баланс и другие. Также важно использовать усовершенствованные аналитические методы для выявления менее очевидных изменений и трендов, что позволит сделать более обоснованные выводы о динамике и состоянии снежного покрова в будущем.





























